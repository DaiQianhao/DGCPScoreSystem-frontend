(function(t){function e(e){for(var o,i,s=e[0],c=e[1],l=e[2],d=0,g=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&g.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(g.length)g.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],o=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var o={},n={app:0},r=[];function i(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=o,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),n=a("f309");o["a"].use(n["a"]);var r=new n["a"]({}),i=a("2f62"),s=a("b054"),c=a.n(s),l=a("a78e"),u=a.n(l),d=a("bc3a"),g=a.n(d),v=a("f576"),p=a.n(v),f=function(){return{logged:!1,username:"",uid:"",loginDialogOpening:!1,autoLogin:!1,token:"",logging:!1,errorBar:{show:!1,text:""},drawer:!1}},m={},b={login:function(t,e){var a=t.dispatch,o=t.commit;g()({method:"post",url:"http://127.0.0.1:44444/api/login",data:{uid:e.uid,password:(new p.a).update(e.password).digest("hex")}}).then((function(t){if(200==t.status){var n=t.data;console.log(n),0==n.code?(o("updateUserInfo",{logged:!0,token:n.token,uid:n.uid,username:n.username,changeCookies:e.autoLogin}),o("updateLoginDialogState",!1),o("isLogging",!1),a("getScores",n.token)):(o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:n.msg}),o("isLogging",!1))}else o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:"在连接到服务器时发生错误, code="+t.status}),o("isLogging",!1)})).catch((function(t){o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:"在连接到服务器时发生错误"+t}),o("isLogging",!1)}))}},h={updateLoginDialogState:function(t,e){t.loginDialogOpening=e},updateErrorBarState:function(t,e){t.errorBar.show=void 0!=e.show?e.show:t.errorBar.show,t.errorBar.text=void 0!=e.text?e.text:t.errorBar.text},updateUserInfo:function(t,e){t.logged=e.logged,1==e.logged?(t.uid=e.uid,t.username=e.username,t.token=e.token,e.changeCookies&&(console.debug("set cookies token="+e.token+", uid="+e.uid+", username="+e.username),u.a.set("token",e.token,{expires:7}),u.a.set("uid",e.uid,{expires:7}),u.a.set("username",e.username,{expires:7}))):(t.uid="",t.username="",t.token="",e.changeCookies&&(u.a.remove("token"),u.a.remove("uid"),u.a.remove("username")))},isLogging:function(t,e){t.logging=e},updateNavigationState:function(t,e){t.drawer=e}},x={state:f,mutations:h,getters:m,actions:b},w=function(){return{datas:void 0,selectedExam:"-1"}},_={getScores:function(t,e){var a=t.commit;g()({method:"GET",url:"http://127.0.0.1:44444/api/getScore?token="+e}).then((function(t){if(200==t.status){var e=t.data;0==e.code?(a("updateDatas",e["exams"]),a("updateNavigationState",!0)):(alert(e.msg),10==e.code&&a("updateUserInfo",{ChangeCookies:!0,logged:!1}))}else alert("在连接到服务器时发生错误, code= + res.status")})).catch((function(t){alert("在连接到服务器时发生错误"+t)}))}},k={updateDatas:function(t,e){t.datas=e},changeSelectedExam:function(t,e){t.selectedExam=e}},S={state:w,actions:_,mutations:k};o["a"].use(i["a"]);var O=!1,V=new i["a"].Store({modules:{login:x,exams:S},strict:O,plugins:O?[c()()]:[]}),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-app",[a("top-bar"),a("login-dialog"),a("navigation"),a("v-main",[t.isExamDataNotNull?a("score-show"):t._e()],1)],1)],1)},D=[],E=a("5530"),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app-bar",{attrs:{color:"white","elevate-on-scroll":"",app:""}},[a("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),a("v-toolbar-title",[t._v("查分系统Pro")]),a("v-spacer"),a("v-toolbar-items",[t.isLogged?a("v-btn",{attrs:{text:""},on:{click:t.refreshScores}},[a("div",[a("span",{staticClass:"login-btn-user-info"},[t._v(t._s(t.username))]),a("br"),a("small",{staticClass:"login-btn-user-info"},[t._v(t._s(t.uid))])])]):a("v-btn",{attrs:{text:""},on:{click:t.openLoginDialog}},[t._v(" 登录 ")])],1)],1)},j=[],C={name:"TopBar",computed:Object(E["a"])({drawer:{get:function(){return this.$store.state.login.drawer},set:function(t){this.$store.commit("updateNavigationState",t)}}},Object(i["b"])({isLogged:function(t){return t.login.logged},username:function(t){return t.login.username},uid:function(t){return t.login.uid},token:function(t){return t.login.token},isLoginDialogOpening:function(t){return t.login.loginDialogOpening}})),methods:{openLoginDialog:function(){this.$store.commit("updateLoginDialogState",!0)},refreshScores:function(){this.$store.dispatch("getScores",this.token)}}},$=C,B=(a("f4ef"),a("2877")),N=a("6544"),I=a.n(N),P=a("40dc"),T=a("5bc1"),A=a("8336"),M=a("2fa4"),U=a("2a7f"),q=Object(B["a"])($,y,j,!1,null,null,null),J=q.exports;I()(q,{VAppBar:P["a"],VAppBarNavIcon:T["a"],VBtn:A["a"],VSpacer:M["a"],VToolbarItems:U["a"],VToolbarTitle:U["b"]});var F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:t.isLoginDialogOpening,callback:function(e){t.isLoginDialogOpening=e},expression:"isLoginDialogOpening"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("登录")])]),a("v-divider"),a("v-form",{ref:"form"},[a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{type:"text",label:"账号",rules:[t.rules.uid],disabled:t.logging,required:""},model:{value:t.uid,callback:function(e){t.uid=e},expression:"uid"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{"append-icon":t.showPassword?"mdi-eye":"mdi-eye-off",type:t.showPassword?"text":"password",rules:[t.rules.password],label:"密码",disabled:t.logging,required:""},on:{"click:append":function(e){t.showPassword=!t.showPassword}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-switch",{attrs:{disabled:t.logging,label:"自动登录"},model:{value:t.autoLogin,callback:function(e){t.autoLogin=e},expression:"autoLogin"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-checkbox",{attrs:{required:"",rules:[t.rules.ua]},scopedSlots:t._u([{key:"label",fn:function(){return[a("div",[t._v(" 我同意 "),a("a",{on:{click:function(e){t.uaDialog=!0}}},[t._v(" 用户协议 ")])])]},proxy:!0}]),model:{value:t.acceptua,callback:function(e){t.acceptua=e},expression:"acceptua"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:t.logging},on:{click:function(e){t.isLoginDialogOpening=!1}}},[t._v(" 关闭 ")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",loading:t.logging},on:{click:t.login}},[t._v(" 登录 ")])],1)],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:t.uaDialog,callback:function(e){t.uaDialog=e},expression:"uaDialog"}},[a("v-card",[a("v-card-title",[t._v("用户协议")]),a("v-divider"),a("v-card-text",[a("v-container",[a("p",{staticClass:"red--text"},[t._v("因为真的很短所以请认真看!")]),a("p",[t._v("1. 出于统计级排和减轻对学校服务器的压力的考虑，我"),a("span",{staticClass:"red--text"},[t._v("需要储存的你的分数、登录到学校服务器的JSESSIONID!但不储存你的账号密码")]),t._v("。")]),a("p",[t._v("2. 在未完全获得齐全级学生分数前，级排仅供参考，并不准确。")]),a("p",[t._v("3. 数据可能有延时。")]),a("p",[t._v("4. 本网页随时可能关闭(((")]),a("p",[t._v("——版本: 20200124.01")])])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.uaDialog=!1}}},[t._v(" 关闭 ")])],1)],1)],1),a("v-snackbar",{scopedSlots:t._u([{key:"action",fn:function(e){var o=e.attrs;return[a("v-btn",t._b({attrs:{color:"pink",text:""},on:{click:function(e){return t.updateErrorBarState(!1,void 0)}}},"v-btn",o,!1),[t._v(" 关闭 ")])]}}]),model:{value:t.bar.show,callback:function(e){t.$set(t.bar,"show",e)},expression:"bar.show"}},[a("v-icon",{attrs:{color:"red"}},[t._v("mdi-alert-circle-outline")]),t._v(" "+t._s(t.bar.text)+" ")],1)],1)},G=[],R=(a("c975"),a("a9e3"),{name:"LoginDialog",data:function(){return{rules:{uid:function(t){return 10==(t||"").length&&!isNaN(Number(t||""))&&-1==(t||"").indexOf(" ")||"请输入10位数的学号"},password:function(t){return(t||"").length>0&&-1==(t||"").indexOf(" ")||"密码不能为空"},ua:function(t){return t||"你需要同意用户协议"}},autoLogin:!1,showPassword:!1,uid:"",password:"",acceptua:!1,uaDialog:!1}},methods:{login:function(){this.$refs.form.validate()&&(this.$store.commit("isLogging",!0),this.$store.dispatch("login",{uid:this.uid,password:this.password,autoLogin:this.autoLogin}))},updateErrorBarState:function(t,e){this.$store.commit("updateErrorBarState",{show:t,text:e})}},computed:Object(E["a"])({isLoginDialogOpening:{get:function(){return this.$store.state.login.loginDialogOpening},set:function(t){0==t&&this.$refs.form.reset(),this.$store.commit("updateLoginDialogState",t)}}},Object(i["b"])({bar:function(t){return t.login.errorBar},logging:function(t){return t.login.logging}}))}),z=R,H=a("b0af"),K=a("99d9"),Q=a("ac7c"),W=a("62ad"),X=a("a523"),Y=a("169a"),Z=a("ce7e"),tt=a("4bd4"),et=a("132d"),at=a("0fd9"),ot=a("2db4"),nt=a("b73d"),rt=a("8654"),it=Object(B["a"])(z,F,G,!1,null,null,null),st=it.exports;I()(it,{VBtn:A["a"],VCard:H["a"],VCardActions:K["a"],VCardText:K["b"],VCardTitle:K["c"],VCheckbox:Q["a"],VCol:W["a"],VContainer:X["a"],VDialog:Y["a"],VDivider:Z["a"],VForm:tt["a"],VIcon:et["a"],VRow:at["a"],VSnackbar:ot["a"],VSpacer:M["a"],VSwitch:nt["a"],VTextField:rt["a"]});var ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",t._l(t.selectedExam,(function(e,o,n){return a("v-col",{key:n,attrs:{cols:"12",sm:"4",md:"3",lg:"2"}},[a("v-card","special"!=o?[a("v-card-title",[t._v(t._s(o))]),a("v-card-text",[t._v(" 分数: "+t._s(e.score)+" "),a("br"),t._v(" 级排: "+t._s(e.rank)+" ")])]:[a("v-card-title",[t._v("特殊")]),a("v-card-text",[t._v(" 总分: "+t._s(e.total)+" "),a("br"),t._v(" 级排: "+t._s(e.grade_rank)+" ")])],1)],1)})),1)],1)},lt=[],ut={name:"ScoreShow",computed:Object(E["a"])({},Object(i["b"])({selectedExam:function(t){return"-1"==t.exams.selectedExam?{}:t.exams.datas[t.exams.selectedExam]["scores"]}}))},dt=ut,gt=Object(B["a"])(dt,ct,lt,!1,null,null,null),vt=gt.exports;I()(gt,{VCard:H["a"],VCardText:K["b"],VCardTitle:K["c"],VCol:W["a"],VContainer:X["a"],VRow:at["a"]});var pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-navigation-drawer",{attrs:{app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"title"},[t._v(" 考试场次 ")])],1)],1),a("v-divider"),0!=Object.keys(t.exams).length?a("v-list-item-group",{attrs:{mandatory:""}},t._l(t.exams,(function(e,o,n){return a("v-list-item",{key:n,attrs:{"two-line":""},on:{click:function(e){return t.changeSelectedExam(o)}}},[a("v-list-item-content",[a("v-list-item-title",[t._v(" "+t._s(e.name)+" ")]),a("v-list-item-subtitle",[t._v(" 缺失: "+t._s(e.missing_number)+" 人 ")])],1)],1)})),1):a("v-list-item",[a("v-list-item-title",[t._v(" 请先登录 ")])],1)],1)],1)},ft=[],mt=(a("4160"),a("b64b"),a("159b"),{name:"Navigation",computed:Object(E["a"])({selectedItem:{get:function(){return this.$store.state.exams.selectedExam},set:function(t){this.$store.commit("changeSelectedExam",t)}},drawer:{get:function(){return this.$store.state.login.drawer},set:function(t){this.$store.commit("updateNavigationState",t)}}},Object(i["b"])({exams:function(t){var e={};return void 0!=t.exams.datas&&Object.keys(t.exams.datas).reverse().forEach((function(a){e[a]=t.exams.datas[a]["examinfo"]})),e}})),methods:{changeSelectedExam:function(t){this.$store.commit("changeSelectedExam",t)}}}),bt=mt,ht=a("8860"),xt=a("da13"),wt=a("5d23"),_t=a("1baa"),kt=a("f774"),St=Object(B["a"])(bt,pt,ft,!1,null,null,null),Ot=St.exports;I()(St,{VDivider:Z["a"],VList:ht["a"],VListItem:xt["a"],VListItemContent:wt["a"],VListItemGroup:_t["a"],VListItemSubtitle:wt["b"],VListItemTitle:wt["c"],VNavigationDrawer:kt["a"]});var Vt=void 0,Lt={name:"App",components:{TopBar:J,LoginDialog:st,ScoreShow:vt,Navigation:Ot},computed:Object(E["a"])({},Object(i["b"])({isExamDataNotNull:function(t){return void 0!=t.exams.datas}})),created:function(){var t=u.a.get("token"),e=u.a.get("uid"),a=u.a.get("username");void 0!=t&&void 0!=e&&void 0!=a?(console.debug("Auto Login Enable"),Vt.$store.commit("updateUserInfo",{logged:!0,token:t,uid:e,username:a,ChangeCookies:!0})):console.debug("Auto Login Disable")}},Dt=Lt,Et=a("7496"),yt=a("f6c4"),jt=Object(B["a"])(Dt,L,D,!1,null,null,null),Ct=jt.exports;I()(jt,{VApp:Et["a"],VMain:yt["a"]});var $t=new o["a"]({vuetify:r,store:V,render:function(t){return t(Ct)}});$t.$mount("#app")},"5d237":function(t,e,a){},f4ef:function(t,e,a){"use strict";a("5d237")}});
//# sourceMappingURL=app.af920e9a.js.map