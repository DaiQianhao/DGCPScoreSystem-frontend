(function(e){function t(t){for(var o,i,s=t[0],c=t[1],l=t[2],d=0,g=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&g.push(n[i][0]),n[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(g.length)g.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],o=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var o={},n={app:0},r=[];function i(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=o,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},1:function(e,t){},2:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),n=a("f309");o["a"].use(n["a"]);var r=new n["a"]({}),i=a("2f62"),s=a("b054"),c=a.n(s),l=a("a78e"),u=a.n(l),d=a("bc3a"),g=a.n(d),v=a("f576"),p=a.n(v),f=function(){return{logged:!1,username:"",uid:"",loginDialogOpening:!1,autoLogin:!1,token:"",logging:!1,errorBar:{show:!1,text:""},drawer:!1}},m={},b={login:function(e,t){var a=e.dispatch,o=e.commit;g()({method:"post",url:"http://scoresystemapi.dogdie.cn:10124/api/login",data:{uid:t.uid,password:(new p.a).update(t.password).digest("hex")}}).then((function(e){if(200==e.status){var n=e.data;console.log(n),0==n.code?(o("updateUserInfo",{logged:!0,token:n.token,uid:n.uid,username:n.username,changeCookies:t.autoLogin}),o("updateLoginDialogState",!1),o("isLogging",!1),a("getScores",n.token)):(o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:n.msg}),o("isLogging",!1))}else o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:"在连接到服务器时发生错误, code="+e.status}),o("isLogging",!1)})).catch((function(e){o("updateErrorBarState",{show:!1,text:void 0}),o("updateErrorBarState",{show:!0,text:"在连接到服务器时发生错误"+e}),o("isLogging",!1)}))}},h={updateLoginDialogState:function(e,t){e.loginDialogOpening=t},updateErrorBarState:function(e,t){e.errorBar.show=void 0!=t.show?t.show:e.errorBar.show,e.errorBar.text=void 0!=t.text?t.text:e.errorBar.text},updateUserInfo:function(e,t){e.logged=t.logged,1==t.logged?(e.uid=t.uid,e.username=t.username,e.token=t.token,t.changeCookies&&(console.debug("set cookies token="+t.token+", uid="+t.uid+", username="+t.username),u.a.set("token",t.token,{expires:7}),u.a.set("uid",t.uid,{expires:7}),u.a.set("username",t.username,{expires:7}))):(e.uid="",e.username="",e.token="",t.changeCookies&&(u.a.remove("token"),u.a.remove("uid"),u.a.remove("username")))},isLogging:function(e,t){e.logging=t},updateNavigationState:function(e,t){e.drawer=t}},x={state:f,mutations:h,getters:m,actions:b},w=function(){return{datas:void 0,selectedExam:"-1"}},_={getScores:function(e,t){var a=e.commit;g()({method:"GET",url:"http://scoresystemapi.dogdie.cn:10124/api/getScore?token="+t}).then((function(e){if(200==e.status){var t=e.data;0==t.code?(a("updateDatas",t["exams"]),a("updateNavigationState",!0)):(alert(t.msg),10==t.code&&a("updateUserInfo",{ChangeCookies:!0,logged:!1}))}else alert("在连接到服务器时发生错误, code= + res.status")})).catch((function(e){alert("在连接到服务器时发生错误"+e)}))}},k={updateDatas:function(e,t){e.datas=t},changeSelectedExam:function(e,t){e.selectedExam=t}},S={state:w,actions:_,mutations:k};o["a"].use(i["a"]);var O=!1,V=new i["a"].Store({modules:{login:x,exams:S},strict:O,plugins:O?[c()()]:[]}),L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-app",[a("top-bar"),a("login-dialog"),a("navigation"),a("v-main",[e.isExamDataNotNull?a("score-show"):e._e()],1)],1)],1)},D=[],E=a("5530"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app-bar",{attrs:{color:"white","elevate-on-scroll":"",app:""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("v-toolbar-title",[e._v("查分系统Pro")]),a("v-spacer"),a("v-toolbar-items",[e.isLogged?a("v-btn",{attrs:{text:""},on:{click:e.refreshScores}},[a("div",[a("span",{staticClass:"login-btn-user-info"},[e._v(e._s(e.username))]),a("br"),a("small",{staticClass:"login-btn-user-info"},[e._v(e._s(e.uid))])])]):a("v-btn",{attrs:{text:""},on:{click:e.openLoginDialog}},[e._v(" 登录 ")])],1)],1)},j=[],C={name:"TopBar",computed:Object(E["a"])({drawer:{get:function(){return this.$store.state.login.drawer},set:function(e){this.$store.commit("updateNavigationState",e)}}},Object(i["b"])({isLogged:function(e){return e.login.logged},username:function(e){return e.login.username},uid:function(e){return e.login.uid},token:function(e){return e.login.token},isLoginDialogOpening:function(e){return e.login.loginDialogOpening}})),methods:{openLoginDialog:function(){this.$store.commit("updateLoginDialogState",!0)},refreshScores:function(){this.$store.dispatch("getScores",this.token)}}},$=C,B=(a("f4ef"),a("2877")),N=a("6544"),I=a.n(N),P=a("40dc"),T=a("5bc1"),A=a("8336"),M=a("2fa4"),U=a("2a7f"),q=Object(B["a"])($,y,j,!1,null,null,null),J=q.exports;I()(q,{VAppBar:P["a"],VAppBarNavIcon:T["a"],VBtn:A["a"],VSpacer:M["a"],VToolbarItems:U["a"],VToolbarTitle:U["b"]});var F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.isLoginDialogOpening,callback:function(t){e.isLoginDialogOpening=t},expression:"isLoginDialogOpening"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("登录")])]),a("v-divider"),a("v-form",{ref:"form"},[a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{type:"text",label:"账号",rules:[e.rules.uid],disabled:e.logging,required:""},model:{value:e.uid,callback:function(t){e.uid=t},expression:"uid"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{"append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"text":"password",rules:[e.rules.password],label:"密码",disabled:e.logging,required:""},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-switch",{attrs:{disabled:e.logging,label:"自动登录"},model:{value:e.autoLogin,callback:function(t){e.autoLogin=t},expression:"autoLogin"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-checkbox",{attrs:{required:"",rules:[e.rules.ua]},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",[e._v(" 我同意 "),a("a",{on:{click:function(t){e.uaDialog=!0}}},[e._v(" 用户协议 ")])])]},proxy:!0}]),model:{value:e.acceptua,callback:function(t){e.acceptua=t},expression:"acceptua"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:"",disabled:e.logging},on:{click:function(t){e.isLoginDialogOpening=!1}}},[e._v(" 关闭 ")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",loading:e.logging},on:{click:e.login}},[e._v(" 登录 ")])],1)],1)],1),a("v-dialog",{attrs:{width:"500"},model:{value:e.uaDialog,callback:function(t){e.uaDialog=t},expression:"uaDialog"}},[a("v-card",[a("v-card-title",[e._v("用户协议")]),a("v-divider"),a("v-card-text",[a("v-container",[a("p",{staticClass:"red--text"},[e._v("因为真的很短所以请认真看!")]),a("p",[e._v("1. 出于统计级排和减轻对学校服务器的压力的考虑，我"),a("span",{staticClass:"red--text"},[e._v("需要储存的你的分数、登录到学校服务器的JSESSIONID!但不储存你的账号密码")]),e._v("。")]),a("p",[e._v("2. 在未完全获得齐全级学生分数前，级排仅供参考，并不准确。")]),a("p",[e._v("3. 数据可能有延时。")]),a("p",[e._v("4. 本网页随时可能关闭(((")]),a("p",[e._v("——版本: 20200124.01")])])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.uaDialog=!1}}},[e._v(" 关闭 ")])],1)],1)],1),a("v-snackbar",{scopedSlots:e._u([{key:"action",fn:function(t){var o=t.attrs;return[a("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){return e.updateErrorBarState(!1,void 0)}}},"v-btn",o,!1),[e._v(" 关闭 ")])]}}]),model:{value:e.bar.show,callback:function(t){e.$set(e.bar,"show",t)},expression:"bar.show"}},[a("v-icon",{attrs:{color:"red"}},[e._v("mdi-alert-circle-outline")]),e._v(" "+e._s(e.bar.text)+" ")],1)],1)},G=[],R=(a("c975"),a("a9e3"),{name:"LoginDialog",data:function(){return{rules:{uid:function(e){return 10==(e||"").length&&!isNaN(Number(e||""))&&-1==(e||"").indexOf(" ")||"请输入10位数的学号"},password:function(e){return(e||"").length>0&&-1==(e||"").indexOf(" ")||"密码不能为空"},ua:function(e){return e||"你需要同意用户协议"}},autoLogin:!1,showPassword:!1,uid:"",password:"",acceptua:!1,uaDialog:!1}},methods:{login:function(){this.$refs.form.validate()&&(this.$store.commit("isLogging",!0),this.$store.dispatch("login",{uid:this.uid,password:this.password,autoLogin:this.autoLogin}))},updateErrorBarState:function(e,t){this.$store.commit("updateErrorBarState",{show:e,text:t})}},computed:Object(E["a"])({isLoginDialogOpening:{get:function(){return this.$store.state.login.loginDialogOpening},set:function(e){0==e&&this.$refs.form.reset(),this.$store.commit("updateLoginDialogState",e)}}},Object(i["b"])({bar:function(e){return e.login.errorBar},logging:function(e){return e.login.logging}}))}),z=R,H=a("b0af"),K=a("99d9"),Q=a("ac7c"),W=a("62ad"),X=a("a523"),Y=a("169a"),Z=a("ce7e"),ee=a("4bd4"),te=a("132d"),ae=a("0fd9"),oe=a("2db4"),ne=a("b73d"),re=a("8654"),ie=Object(B["a"])(z,F,G,!1,null,null,null),se=ie.exports;I()(ie,{VBtn:A["a"],VCard:H["a"],VCardActions:K["a"],VCardText:K["b"],VCardTitle:K["c"],VCheckbox:Q["a"],VCol:W["a"],VContainer:X["a"],VDialog:Y["a"],VDivider:Z["a"],VForm:ee["a"],VIcon:te["a"],VRow:ae["a"],VSnackbar:oe["a"],VSpacer:M["a"],VSwitch:ne["a"],VTextField:re["a"]});var ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",e._l(e.selectedExam,(function(t,o,n){return a("v-col",{key:n,attrs:{cols:"12",sm:"4",md:"3",lg:"2"}},[a("v-card","special"!=o?[a("v-card-title",[e._v(e._s(o))]),a("v-card-text",[e._v(" 分数: "+e._s(t.score)+" "),a("br"),e._v(" 级排: "+e._s(t.rank)+" ")])]:[a("v-card-title",[e._v("特殊")]),a("v-card-text",[e._v(" 总分: "+e._s(t.total)+" "),a("br"),e._v(" 级排: "+e._s(t.grade_rank)+" ")])],1)],1)})),1)],1)},le=[],ue={name:"ScoreShow",computed:Object(E["a"])({},Object(i["b"])({selectedExam:function(e){return"-1"==e.exams.selectedExam?{}:e.exams.datas[e.exams.selectedExam]["scores"]}}))},de=ue,ge=Object(B["a"])(de,ce,le,!1,null,null,null),ve=ge.exports;I()(ge,{VCard:H["a"],VCardText:K["b"],VCardTitle:K["c"],VCol:W["a"],VContainer:X["a"],VRow:ae["a"]});var pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-list",[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",{staticClass:"title"},[e._v(" 考试场次 ")])],1)],1),a("v-divider"),0!=Object.keys(e.exams).length?a("v-list-item-group",{attrs:{mandatory:""}},e._l(e.exams,(function(t,o,n){return a("v-list-item",{key:n,attrs:{"two-line":""},on:{click:function(t){return e.changeSelectedExam(o)}}},[a("v-list-item-content",[a("v-list-item-title",[e._v(" "+e._s(t.name)+" ")]),a("v-list-item-subtitle",[e._v(" 缺失: "+e._s(t.missing_number)+" 人 ")])],1)],1)})),1):a("v-list-item",[a("v-list-item-title",[e._v(" 请先登录 ")])],1)],1)],1)},fe=[],me=(a("4160"),a("b64b"),a("159b"),{name:"Navigation",computed:Object(E["a"])({selectedItem:{get:function(){return this.$store.state.exams.selectedExam},set:function(e){this.$store.commit("changeSelectedExam",e)}},drawer:{get:function(){return this.$store.state.login.drawer},set:function(e){this.$store.commit("updateNavigationState",e)}}},Object(i["b"])({exams:function(e){var t={};return void 0!=e.exams.datas&&Object.keys(e.exams.datas).reverse().forEach((function(a){t[a]=e.exams.datas[a]["examinfo"]})),t}})),methods:{changeSelectedExam:function(e){this.$store.commit("changeSelectedExam",e)}}}),be=me,he=a("8860"),xe=a("da13"),we=a("5d23"),_e=a("1baa"),ke=a("f774"),Se=Object(B["a"])(be,pe,fe,!1,null,null,null),Oe=Se.exports;I()(Se,{VDivider:Z["a"],VList:he["a"],VListItem:xe["a"],VListItemContent:we["a"],VListItemGroup:_e["a"],VListItemSubtitle:we["b"],VListItemTitle:we["c"],VNavigationDrawer:ke["a"]});var Ve=void 0,Le={name:"App",components:{TopBar:J,LoginDialog:se,ScoreShow:ve,Navigation:Oe},computed:Object(E["a"])({},Object(i["b"])({isExamDataNotNull:function(e){return void 0!=e.exams.datas}})),created:function(){var e=u.a.get("token"),t=u.a.get("uid"),a=u.a.get("username");void 0!=e&&void 0!=t&&void 0!=a?(console.debug("Auto Login Enable"),Ve.$store.commit("updateUserInfo",{logged:!0,token:e,uid:t,username:a,ChangeCookies:!0})):console.debug("Auto Login Disable")}},De=Le,Ee=a("7496"),ye=a("f6c4"),je=Object(B["a"])(De,L,D,!1,null,null,null),Ce=je.exports;I()(je,{VApp:Ee["a"],VMain:ye["a"]});var $e=new o["a"]({vuetify:r,store:V,render:function(e){return e(Ce)}});$e.$mount("#app")},"5d237":function(e,t,a){},f4ef:function(e,t,a){"use strict";a("5d237")}});
//# sourceMappingURL=app.3c3bea2d.js.map